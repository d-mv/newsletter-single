(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{102:function(e,t,a){"use strict";a.r(t);var n=a(95),o=a(80),s=a(81),r=a(96),c=a(82),l=a(97),u=a(0),i=a.n(u),d=a(10),p=a(15),m=a(6),f=a.n(m);var h=a(27);var _=a(21),g=a(83),S=a.n(g),E=function(){return i.a.createElement("h1",{className:S.a.header},"The Newsletter")},w=a(71),v=a(84),b=a.n(v),P=function(e){return i.a.createElement("h3",{className:b.a.title},Object(w.a)(e.date))},y=a(85),k=a.n(y),I=function(){return i.a.createElement("header",{className:k.a.header},i.a.createElement(E,null),i.a.createElement(P,{date:new Date}))},C=a(68),F=a(86),R=a.n(F),T=function(e){var t;return t="refresh"===e.mode?R.a.smartRotate:e.accent?R.a.smartAccented:R.a.smart,i.a.createElement("button",{className:t,"aria-label":e.mode,onClick:function(){return function(e){"BACK"===e.child||"HOME"===e.child?e.func("posts"):"SOURCES"===e.child?e.func("sources"):"profile"===e.mode?e.func("profile"):e.func()}({mode:e.mode,child:e.children,func:e.function})}},e.children)},M=a(87),N=a.n(M),O=function(e){return i.a.createElement(T,{accent:e.accent,mode:e.mode,function:e.function},e.element)},A=function(e){var t=O({element:"post"===e.mode?"BACK":"HOME",mode:"home",accent:!1,function:e.moduleToggle}),a=O({element:"SOURCES",mode:"sources",accent:!1,function:e.moduleToggle}),n="posts"===e.mode?O({element:e.read?i.a.createElement(C.d,null):i.a.createElement(C.e,null),mode:"showRead",accent:e.read,function:e.toggleRead}):null,o="posts"===e.mode?O({element:i.a.createElement(C.g,null),mode:"refresh",accent:!1,function:e.refresh}):null,s="posts"===e.mode?O({element:i.a.createElement(C.f,null),mode:"filter",accent:e.showFilter,function:e.toggleFilter}):null,r=O({element:i.a.createElement(C.i,null),mode:"profile",accent:!1,function:e.moduleToggle});return i.a.createElement("nav",{className:N.a.menu},t,a,n,s,o,r)},L=a(14),U=a(75),D=a(72),j=a(74),B=a(69),x=a.n(B),H=function(e){var t="".concat(e.post.text.replace(/<(?:.|\n)*?>/gm," "),"..."),a=e.post.star?i.a.createElement(U.a,null):i.a.createElement(U.b,null),n=e.post.read?i.a.createElement(C.b,null):i.a.createElement(C.a,null);return i.a.createElement("article",{className:x.a.card},i.a.createElement("h3",{className:x.a.title,onClick:function(){e.select({id:e.post._id})}},e.post.title),i.a.createElement(D.a,{mode:"card",source:e.post.source,author:e.post.author,buttons:{star:a,read:n},read:e.post.read,star:e.post.star,update:e.update,id:e.post._id}),i.a.createElement("main",{className:x.a.text,onClick:function(){e.select({id:e.post._id})}},t),i.a.createElement(j.a,{timestamp:e.post.published,readingTime:e.post.readTime}))},q=a(89),z=a.n(q),J=function(e){return i.a.createElement("div",{className:z.a.list},e.posts.map(function(t){var a=function(e){return i.a.createElement(H,{key:e.post._id,post:e.post,update:e.update,select:e.select})}({post:t,update:e.update,select:e.selectPost});return function(e){return e.filter?e.show?e.pSource===e.filter:e.pRead===e.show&&e.pSource===e.filter:!!e.show||e.pRead===e.show}({show:e.showRead,filter:e.filter,pRead:t.read,pSource:t.sourceId})?a:null}))},G=(a(33),i.a.lazy(function(){return a.e(11).then(a.bind(null,98))})),K=i.a.lazy(function(){return a.e(7).then(a.bind(null,99))}),V=i.a.lazy(function(){return a.e(8).then(a.bind(null,100))}),W=i.a.lazy(function(){return a.e(5).then(a.bind(null,104))}),Q=i.a.lazy(function(){return a.e(9).then(a.bind(null,101))}),X=i.a.lazy(function(){return a.e(10).then(a.bind(null,76))}),Y={_id:"",source:"",sourceId:"",title:"",url:"",author:"",published:new Date,parsed:new Date,text:"",readTime:0,pages:0,read:!1,star:!1},Z=function(e){function t(){var e,a;Object(o.a)(this,t);for(var s=arguments.length,l=new Array(s),d=0;d<s;d++)l[d]=arguments[d];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={loading:!0,module:"posts",showRead:!1,showFilter:!1,filterId:"",sources:[],posts:[],message:"",showPost:Y,addSource:!1},a.loadPosts=function(e){a.props.loadPosts(e).then(function(e){a.setState({posts:e.payload.data,loading:!1})})},a.loadSources=function(e){a.props.loadSources(e).then(function(e){a.setState({sources:e.payload.data,loading:!1})})},a.fetchPostsSources=function(){var e={token:a.props.currentUser.token,action:["post","fetch"]},t={token:a.props.currentUser.token,action:["source","fetch"]};a.loadPosts(e),a.loadSources(t)},a.showModule=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"posts";console.log("show module - "+e),a.setState({module:e})},a.toggleShowRead=function(){a.setState({showRead:!a.state.showRead}),a.changeMessage("Show read: ".concat(!a.state.showRead))},a.toggleShowFilter=function(){a.setState({showFilter:!a.state.showFilter})},a.changeMessage=function(e){a.setState({message:e}),setTimeout(function(){return a.setState({message:""})},3e3)},a.chooseFilter=function(e){a.toggleShowFilter(),"clear"===e?a.setState({filterId:""}):a.setState({filterId:e})},a.handleRefreshClick=function(){var e={token:a.props.currentUser.token,action:["post","refresh"]};a.props.apiRequest(e).then(function(e){var t=e.payload.data.message;a.changeMessage(t)})},a.selectPostToShow=function(e){var t={token:a.props.currentUser.token,action:["post","show"],id:e.id};a.props.apiRequest(t).then(function(e){var t=e.payload.data;t.authed&&(a.showModule("post"),a.setState({showPost:t.post}))})},a.updateStatePosts=function(e){var t,n=a.state.posts;return n.filter(function(t){return t._id===e.id}).forEach(function(a){"read"===e.field?(t=a.read,a.read=!a.read):(t=a.star,a.star=!a.star)}),a.setState({posts:n}),t},a.updatePostAction=function(e){var t=a.updateStatePosts({id:e.id,field:e.field}),n={};n["".concat(e.field)]=!t;var o={token:a.props.currentUser.token,action:["post","update"],id:e.id,fields:n};a.props.updatePost(o).then(function(e){var t=e.payload.data.message;a.changeMessage(t)})},a.updateSourceInState=function(e){var t=a.state.sources;t.filter(function(t){return t._id===e._id}).forEach(function(t){t.name=e.name,t.url=e.url,t.homepage=e.homepage}),a.setState({source:t})},a.updateSourceAction=function(e){console.log(e);var t={token:a.props.currentUser.token,action:["source","update"],fields:e};a.props.apiRequest(t).then(function(t){console.log(t);var n=t.payload.data.message;a.changeMessage(n),a.updateSourceInState(e)})},a.deleteAction=function(e){console.log(e);var t={token:a.props.currentUser.token,action:[e.mode,"delete"],id:e.id};a.props.apiRequest(t).then(function(t){console.log(t);var n=t.payload.data.message;a.changeMessage(n),a.updateSourceInState(e)})},a.createSource=function(e){console.log("- create source:"),console.log(e);var t={token:a.props.currentUser.token,action:["source","create"],fields:e},o=e;o._id="012345";var s=[o],r=[].concat(Object(n.a)(a.state.sources),s);a.props.apiRequest(t).then(function(e){var t=e.payload.data;console.log(t),a.changeMessage(t.message),a.setState({addSource:!1,sources:r})})},a.toggleShowAddSource=function(){a.setState({addSource:!a.state.addSource})},a.checkIfSourcesEmpty=function(){return a.state.sources===[]||0===a.state.sources.length},a.checkIfPostsSourcesEmpty=function(){var e;return!a.checkIfSourcesEmpty()||a.state.posts!==[]&&0!==a.state.posts.length?a.state.posts!==[]&&0!==a.state.posts.length||(e="The are no posts for now."):e="There are no sources configured.",e},a.profile=i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(Q,{currentUser:a.props.currentUser,signOff:a.props.signOff})),a.addSource=i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(X,{submit:a.createSource,close:a.toggleShowAddSource})),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.fetchPostsSources(),this.refresher=setInterval(this.fetchPostsSources,1e4),window.scrollTo(0,0)}},{key:"componentWillUnmount",value:function(){clearInterval(this.refresher)}},{key:"render",value:function(){var e,t,a=i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(V,{post:this.state.showPost,update:this.updatePostAction})),n=i.a.createElement(A,{read:this.state.showRead,toggleRead:this.toggleShowRead,refresh:this.handleRefreshClick,moduleToggle:this.showModule,mode:this.state.module,showFilter:""!==this.state.filterId,toggleFilter:this.toggleShowFilter}),o=this.state.showFilter&&this.state.sources?i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(K,{toggle:this.toggleShowFilter,list:this.state.sources,choose:this.chooseFilter,id:this.state.filterId})):null,s=this.checkIfPostsSourcesEmpty();e=this.state.loading?i.a.createElement(L.a,null):s?i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(G,{message:s})):i.a.createElement(J,{showRead:this.state.showRead,posts:this.state.posts,selectPost:this.selectPostToShow,update:this.updatePostAction,filter:this.state.filterId}),t=this.checkIfSourcesEmpty()?i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(G,{message:"The are no sources for now.",function:this.toggleShowAddSource},i.a.createElement("button",{className:"button","aria-label":"Add source"},"Add source"))):i.a.createElement(u.Suspense,{fallback:i.a.createElement(L.a,null)},i.a.createElement(W,{sources:this.state.sources,submit:this.createSource,update:this.updateSourceAction}));var r=this.state.message?i.a.createElement("section",{className:"message"},this.state.message):null;return i.a.createElement("main",{"data-test":"app"},i.a.createElement(I,null),n,o,r,"posts"===this.state.module?e:null,"post"===this.state.module?a:null,"sources"===this.state.module?t:null,this.state.addSource?this.addSource:null,"profile"===this.state.module?this.profile:null)}}]),t}(i.a.Component);t.default=Object(d.b)(function(e){return{user:e.user}},{loadPosts:function(e){var t=f.a.post("/",{query:e}).then(function(e){return e}).catch(function(e){return e});return{type:p.b,payload:t}},updatePost:function(e){var t=f.a.post("/",{query:e}).then(function(e){return e}).catch(function(e){return e});return{type:p.c,payload:t}},selectPost:function(e){var t=f.a.get("/post/".concat(e)).then(function(e){return e}).catch(function(e){return e});return{type:p.a,payload:t}},loadSources:function(e){var t=f.a.post("/",{query:e}).then(function(e){return e}).catch(function(e){return e});return{type:h.a,payload:t}},apiRequest:_.a})(Z)},69:function(e,t,a){e.exports={card:"PostCard_card__2J-H1",scaleUp:"PostCard_scaleUp__3oKww",text:"PostCard_text__1jLmP",title:"PostCard_title__3Vi12",line:"PostCard_line__1mgL2",footer:"PostCard_footer__1aTwF",wrapper:"PostCard_wrapper__2E9fT",sub:"PostCard_sub__2hKdg",slideInFromTop:"PostCard_slideInFromTop__2REAI",slideInFromLeft:"PostCard_slideInFromLeft__FabEc",growLarge:"PostCard_growLarge__g5rIF",slideDown:"PostCard_slideDown__XTYyj",rotate:"PostCard_rotate__2m0Yg",disappear:"PostCard_disappear__37Is8"}},71:function(e,t,a){"use strict";var n={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},o={1:"Sun",2:"Mon",3:"Tue",4:"Wed",5:"Thu",6:"Fri",7:"Sat"};t.a=function(e){var t=new Date;Object.keys(e).length||(t=new Date(e));var a="".concat(t.getHours(),":").concat(t.getMinutes()," am");return t.getHours()>12&&(a="".concat(t.getHours()-12,":").concat(t.getMinutes()," pm")),"".concat(o[t.getDay()+1]," ").concat(t.getDate()," ").concat(n[t.getMonth()+1]," at ").concat(a)}},72:function(e,t,a){"use strict";var n=a(0),o=a.n(n),s=a(73),r=a(69),c=a.n(r);t.a=function(e){var t="show"===e.mode?"".concat(e.author," @ ").concat(e.source):"@".concat(e.source);return o.a.createElement("section",{className:c.a.line,"data-test":"component__post-line"},o.a.createElement("div",{className:c.a.wrapper},t),o.a.createElement("div",{className:c.a.wrapper},o.a.createElement(s.a,{update:e.update,id:e.id,mode:"star",status:e.star,"data-test":"component__post-line--button"},e.buttons.star),o.a.createElement(s.a,{update:e.update,id:e.id,mode:"read",status:e.read,"data-test":"component__post-line--button"},e.buttons.read)))}},73:function(e,t,a){"use strict";var n=a(0),o=a.n(n),s=a(88),r=a.n(s);t.a=function(e){var t=e.status?o.a.createElement("span",{className:r.a.onStatus},e.children):o.a.createElement("span",{className:r.a.offStatus},e.children);return o.a.createElement("button",{className:r.a.post,"aria-label":e.mode,onClick:function(){return e.update({field:e.mode,id:e.id})}},t)}},74:function(e,t,a){"use strict";var n=a(0),o=a.n(n),s=a(71),r=a(69),c=a.n(r);t.a=function(e){var t="~".concat(e.readingTime," mins"),a=e.parsed?o.a.createElement("div",{className:c.a.wrapper},o.a.createElement("span",{className:c.a.span},"parsed: "),Object(s.a)(e.parsed)):null;return o.a.createElement("footer",{className:c.a.footer},o.a.createElement("div",{className:c.a.wrapper},o.a.createElement("span",{className:c.a.span},"posted: "),Object(s.a)(e.timestamp)),a,o.a.createElement("div",{className:c.a.wrapper},t))}},83:function(e,t,a){e.exports={header:"Title_header__a8239"}},84:function(e,t,a){e.exports={title:"Timestamp_title__1oVzj"}},85:function(e,t,a){e.exports={header:"Header_header__4gWOG"}},86:function(e,t,a){e.exports={smart:"SmartButton_smart__2LjGI",smartAccented:"SmartButton_smartAccented__3QZCJ",smartRotate:"SmartButton_smartRotate__2lr2t",rotate:"SmartButton_rotate__2cqkO",scaleUp:"SmartButton_scaleUp__26vHE",slideInFromTop:"SmartButton_slideInFromTop__1MliQ",slideInFromLeft:"SmartButton_slideInFromLeft__3Xj3w",growLarge:"SmartButton_growLarge__3AZ2_",slideDown:"SmartButton_slideDown__37h5C",disappear:"SmartButton_disappear__3verO"}},87:function(e,t,a){e.exports={menu:"SmartMenu_menu__2dsRy",slideDown:"SmartMenu_slideDown__2HD0v",scaleUp:"SmartMenu_scaleUp__2ghSY",slideInFromTop:"SmartMenu_slideInFromTop__1iIxf",slideInFromLeft:"SmartMenu_slideInFromLeft__3WgAG",growLarge:"SmartMenu_growLarge__3i7pH",rotate:"SmartMenu_rotate__caE1e",disappear:"SmartMenu_disappear__3UryS"}},88:function(e,t,a){e.exports={post:"PostButton_post__3eHpg",status:"PostButton_status__3B7IS",onStatus:"PostButton_onStatus__3XZOD",offStatus:"PostButton_offStatus__3nzNP"}},89:function(e,t,a){e.exports={button:"PostCardList_button__1iLb_",modal:"PostCardList_modal__2ji0D",central:"PostCardList_central__2rVGP",display:"PostCardList_display__3V18P",list:"PostCardList_list__2tmb4",message:"PostCardList_message__2tQPO"}}}]);
//# sourceMappingURL=3.21a4b11a.chunk.js.map